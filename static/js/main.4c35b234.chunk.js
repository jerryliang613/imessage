(this["webpackJsonpimessage-clone"]=this["webpackJsonpimessage-clone"]||[]).push([[0],{64:function(e,t,a){},68:function(e,t,a){},72:function(e,t,a){"use strict";a.r(t);var c=a(5),s=a(2),n=a.n(s),i=a(19),r=a.n(i),o=(a(64),a(12)),l=(a(68),a(23)),d=a(89),j=a(90),u=a(92),m=a(38),h=a(25),b=Object(h.b)({name:"user",initialState:null,reducers:{login:function(e,t){return Object(m.a)({},t.payload)},logout:function(e){return null}}}),O=b.actions,p=O.login,f=O.logout,g=function(e){return e.user},x=b.reducer,v=Object(s.forwardRef)((function(e,t){var a=e.data,s=a.message,n=a.timestamp,i=a.photo,r=a.email,l=Object(o.c)(g);return Object(c.jsxs)("div",{ref:t,className:"message ".concat(r===l.email?"message_sender":""),children:[Object(c.jsx)(u.a,{className:"message_photo",src:i}),Object(c.jsx)("p",{children:s}),Object(c.jsx)("small",{children:n&&n.toDate().toLocaleTimeString()})]})})),N=Object(h.b)({name:"chat",initialState:{chatId:null,chatName:null},reducers:{setChat:function(e,t){return Object(m.a)({},t.payload)}}}),S=N.actions.setChat,y=function(e){return e.chat.chatId},w=function(e){return e.chat.chatName},_=N.reducer,I=a(27),k=I.a.initializeApp({apiKey:"AIzaSyBbtEqwjJpm4AN_8UG9Zzt-8obwQsHlnM8",authDomain:"imessage-9f410.firebaseapp.com",databaseURL:"https://imessage-9f410-default-rtdb.firebaseio.com",projectId:"imessage-9f410",storageBucket:"imessage-9f410.appspot.com",messagingSenderId:"689816575830",appId:"1:689816575830:web:fa16a9027eeaea21d440f7",measurementId:"G-DW3K33TTES"}).firestore(),C=I.a.auth(),T=new I.a.auth.GoogleAuthProvider,D=k,E=a(52),A=function(){var e=Object(s.useState)(""),t=Object(l.a)(e,2),a=t[0],n=t[1],i=Object(o.c)(w),r=Object(o.c)(y),u=Object(s.useState)([]),m=Object(l.a)(u,2),h=m[0],b=m[1],O=Object(o.c)(g);Object(s.useEffect)((function(){r&&D.collection("chats").doc(r).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return b(e.docs.map((function(e){return{data:e.data()}})))}))}),[r]);return Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsx)("div",{className:"chat_header",children:Object(c.jsx)("h4",{children:Object(c.jsxs)("span",{className:"chat_name",children:["To: ",i]})})}),Object(c.jsx)("div",{className:"chat_messages",children:Object(c.jsx)(E.a,{children:h.map((function(e){var t=e.data;return Object(c.jsx)(v,{data:t},t.timestamp)}))})}),Object(c.jsxs)("div",{className:"chat_input",children:[Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),r?a.trim()?(D.collection("chats").doc(r).collection("messages").add({message:a,timestamp:I.a.firestore.FieldValue.serverTimestamp(),uid:O.uid,photo:O.photo,email:O.email,displayName:O.displayName}),n("")):alert("Please say something"):alert("Please create a channel first")},children:[Object(c.jsx)("input",{type:"text",placeholder:"iMessage",value:a,onChange:function(e){e.preventDefault(),n(e.target.value)}}),Object(c.jsx)("input",{type:"submit",value:"Send Message"})]}),Object(c.jsx)(d.a,{children:Object(c.jsx)(j.a,{})})]})]})},B=a(91),L=a.p+"static/media/imessage.2ee5a3f6.png",M=function(){return Object(c.jsxs)("div",{className:"login",children:[Object(c.jsxs)("div",{className:"login_logo",children:[Object(c.jsx)("img",{src:L,alt:""}),Object(c.jsx)("h1",{children:"iMessage"})]}),Object(c.jsx)(B.a,{onClick:function(){C.signInWithPopup(T).catch((function(e){return alert(e.message)}))},children:"Sign in"})]})},P=a(53),W=a.n(P),z=a(54),G=a.n(z),J=function(e){var t,a,n,i=e.id,r=e.chatName,d=Object(o.b)(),j=Object(s.useState)([]),m=Object(l.a)(j,2),h=m[0],b=m[1];Object(s.useEffect)((function(){D.collection("chats").doc(i).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return b(e.docs.map((function(e){return e.data()})))}))}),[i]);return Object(c.jsxs)("div",{className:"sidebarchat",onClick:function(){d(S({chatId:i,chatName:r}))},children:[Object(c.jsx)(u.a,{}),Object(c.jsxs)("div",{className:"sidebarchat_info",children:[Object(c.jsx)("h3",{children:r}),Object(c.jsx)("p",{children:null===(t=h[0])||void 0===t?void 0:t.message}),Object(c.jsx)("small",{children:null===(a=h[0])||void 0===a||null===(n=a.timestamp)||void 0===n?void 0:n.toDate().toLocaleTimeString()})]})]})},R=function(){var e=Object(o.c)(g),t=Object(o.b)(),a=Object(s.useState)([]),n=Object(l.a)(a,2),i=n[0],r=n[1];Object(s.useEffect)((function(){D.collection("chats").onSnapshot((function(e){return r(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]);return Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsxs)("div",{className:"sidebar_header",children:[Object(c.jsx)(u.a,{onClick:function(){t(f()),C.signOut()},src:e.photo,className:"sidebar_avatar"}),Object(c.jsxs)("div",{className:"sidebar_input",children:[Object(c.jsx)(W.a,{}),Object(c.jsx)("input",{type:"text",placeholder:"search"})]}),Object(c.jsx)(d.a,{onClick:function(){var e=prompt("Please enter a chat name");e&&D.collection("chats").add({chatName:e,chatTime:(new Date).toLocaleTimeString()})},variant:"outlined",className:"sidebar_inputbutton",children:Object(c.jsx)(G.a,{})})]}),Object(c.jsx)("div",{className:"sidebar_chat",children:i.map((function(e){var t=e.id,a=e.data.chatName;return Object(c.jsx)(J,{id:t,chatName:a},t)}))})]})};var U=function(){var e=Object(o.c)(g),t=Object(o.b)();return Object(s.useEffect)((function(){C.onAuthStateChanged((function(e){if(e){var a={uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName};t(p(a))}else t(f())}))}),[]),Object(c.jsx)("div",{className:"App",children:e?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(R,{}),Object(c.jsx)(A,{})]}):Object(c.jsx)(M,{})})},F=Object(h.a)({reducer:{user:x,chat:_}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(o.a,{store:F,children:Object(c.jsx)(U,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[72,1,2]]]);
//# sourceMappingURL=main.4c35b234.chunk.js.map